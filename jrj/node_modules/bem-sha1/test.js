'use strict'

var assert = require("assert");
var sha1 = require('./');

describe('sha1', function() {

  it('加密123', function(done) {
    var encrypt = sha1('123');
    assert(encrypt === '40bd001563085fc35165329ea1ff5c5ecbdbbeef');
    done();
  });

  it('用key加密123', function(done) {
    var encrypt = sha1('open/appId=aX6ymAdBspfKxzkoo6SpN7h2MyBhaTtf&code=123&nonce=123&requestId=r1&t=1461833773080', 'hrQPjsrR7ZTbSqaSRvcbwGZZ2boQcqFG');
    assert.equal(encrypt, 'd4a5b6721d75a5ac15ec698818c77fe1f6e40187');
    done();
  });

  it('base64 加密123', function(done) {
    var encrypt = sha1.base64('123');
    assert.equal(encrypt, 'QL0AFWMIX8NRZTKeof9cXsvbvu8=');
    done();
  });

  it('base64 用key加密123', function(done) {
    var encrypt = sha1.base64('123', 'key');
    assert.equal(encrypt, '1KW2ch11pawV7GmIGMd/4fbkAYc=');
    done();
  });

});
