<!DOCTYPE html>
<html lang="en">
<head>
    <title>银证转账</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="Keywords" content="Keywords">
    <meta name="Description" content="Description">
    <script type="text/javascript" src="/html/js/jquery-1.7.2.min.js"></script>
    <style>
	body, div, p, h1, h2, h3, h4, h5, h6, blockquote, dl, dt, dd, ul, ol, li, pre, form, fieldset, legend, button, input, textarea, table, th, td {
  margin: 0;  padding: 0; }

address, cite, em, i {  font-style: normal; }

body {  color: #fff;  -webkit-appearance: none;  background: #fff;  overflow-x: hidden;  font-family: Microsoft Yahei;  color: #878C92; }

li {  list-style: none; }

a {  color: #535862;  text-decoration: none; }

a:hover {  color: #c40000;  text-decoration: underline; }

legend {  color: #000; }

fieldset, img {  border: 0; }

table {  border-collapse: collapse;  border-spacing: 0; }

input[type="button"], input[type="submit"], input[type="reset"] {  cursor: pointer; }

.clearfix:after, .wrapper:after {  visibility: hidden;  display: block;  font-size: 0;  content: " ";  clear: both;  height: 0; }

.clearfix {  display: inline-block; }

/* start commented backslash hack \*/
* html .clearfix {  height: 1%; }

.clearfix {  display: block; }

/* close commented backslash hack */
.middle * {  display: inline-block;  vertical-align: middle; }

/* height */
/* public */
/* link color */
.red {  color: #f42b13; }

.green {  color: #16c154; }

.black {  color: black; }

.gray {  color: #666; }

.blue {  color: #2899f2; }

.orange {  color: #cb420c; }

/* public */
.flex {  box-flex: 1;  -webkit-box-flex: 1; }

input {  outline: none; }

/* layout */
.hide {  display: none; }

.container {  position: relative;  z-index: 1;  width: 100%;  transition-duration: 1s;  -webkit-transition-duration: 1s;  overflow: hidden; height:100%;}
html{height:100%;}
body {  background: #EFEFF4; height:100%;}

::input-placeholder {  color: #DBDBDB; }

::-webkit-input-placeholder {  color: #DBDBDB; }

.app{ position: relative; z-index: 9; }
.app nav {  height: 1.875rem; line-height: 1.875rem;  margin: 0.9375rem 0.75rem 0.625rem; display: box; display: -webkit-box; box-orient: horizontal;  -webkit-box-orient: horizontal;
  box-pack: center;  -webkit-box-pack: center;  box-align: center;  -webkit-box-align: center; }
.app nav li {    height: 100%; border: 0.0625rem solid #333333;  font-size: 0.8125rem; transition-duration: 0.3s; -webkit-transition-duration: 0.3s;  box-flex: 1; color:#333;
    -webkit-box-flex: 1;  text-align: center;  background: #fff; }
.app nav li:first-child { border-top-left-radius: 0.25rem; border-bottom-left-radius: 0.25rem; }
.app nav li:last-child { border-top-right-radius: 0.25rem; border-bottom-right-radius: 0.25rem; }
.app nav li.current { background: #333; color: #fff; }

.app .options ul { width: 100%; height: 3.75rem; padding: 0 0.75rem; display: box; display: -webkit-box; box-orient: horizontal;
  -webkit-box-orient: horizontal; box-pack: center; -webkit-box-pack: center; box-align: center; -webkit-box-align: center; -webkit-box-sizing: border-box;
  -ms-box-sizing: border-box; box-sizing: border-box; border-bottom: 1px solid #DBDBDB; color: #878C92; background: #fff; }
.app .options ul li {   font-size: .875rem; }
.app .options ul li:nth-child(2) {  padding-left: 1.25rem; }
.app .options ul .label { width: 4rem;  text-align: left; }
.app .options ul input{ font-size:.875rem;}
.app .options ul input.flex { display: block; width:100%; height: 1.5625rem; line-height: 1.5625rem; border: none; }
.app .options ul .close{ width: 1rem; height: 1rem; background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABGBJREFUaAXVmrtOG0EUhtdrA7YlkFJQGAtZgIs8QKSkDEVoA32oorxAitTUFHmDSJGSPqElBSkTiQdIwUUWMi4okLBkm4sh51vNLOtlb7M2Zn0kM7sz55z5/5kzs3MhZ41ATk5OSr1e7424Ws3lcs8lrd/d3T2TdFa5b0v+uTwfSP4/SfeKxeKvxcXFripPneTSWjYajWfX19dvxZ7fmgArm/gSQh3R35XfztTU1E6tVoOgsRgTOD09LXc6nY8C+JPUplvYuGKfAT20XS6XPy8sLEAssSQmIIDzh4eH78XzljxXEtdgoCgkWvhfWVn5Is/9JKaJCEiMVy8vL38K8BdJnA6rI+D3Z2Zm1mWMNON8xRI4Pj5+2e/3fzxWq4cBpDfy+fzG0tLS3zAd8u2owqOjo3cC/ve4wYOJOqkbDFEYQ3tAgf8WZTyuMumJzeXl5e9B9QUSUGFDyxeDjMadJ+HUExKvg8LpQQgxYFXMZwI8jUVDggls/sYbICCKeTXbPMo06a/c5J0xobDlvXYDBJjnRXEsU6UXRNJnsKlvkWvijgH1hWWtkrnWd9HKA9OrfLHr+ovt9oBaHmQaPERoYLBqUk4PsDC7urpqSKbx2kZaxJIZwrq5udE+E6WFQsGSgQmgRPo+pfb09LSs/2rnBQrUqtIY/NzcnDU/P0+3Wt1u12q1Wtbt7a2vrsFX27atSqVilUolB/zZ2Zl1cXExqBT/Nqswf9UhxJLYSACtwWMIoGq1agEwTChDB13E7yPMLiTfwWyzGRGFtRCl0GzCBgBekQVYKAkNHh2v4ANfKWQN7DY7KYlDo80IlRHzhI1fgkiEgccWH6bjBzswg53+XiUjjRDz8nF5YOolEQUeW3wMIau2dCF72FTCgG02m5EkiHl/2FAZ4LGNG/RRwMBOD9SjlOLK4kg8FniFq25LLHF6MJREkfA7HkXLa59gpweM53/twJsmITFK8Kru2fBJ24suw88QaI8CX9Rso/17ZyedN2TaZhZKdaDkrTgJeK0/ShJgpwcOtPM0aRR4Yp6fX0ZI4oBZiLPKVBIHnnk+7juBj7QCdqz30jpgVRk3z0fNTtjiYwjZszklllgyOo+kQtbzelXpBRA0VUaRwAe+TAXMYLfVETenxEYStBkJAq+dhpGQMHA2NlrPIN0Fuw7AHQNDR5WK2YyQIqwq49Y2moRexfp9OI6S/3EwT/yW0ukB9pYSU9vJyd9r0opp1vPY6N6795bsCaz6QkSHkMXlghQMtThPVv1wWmAEq/biElDnLFu6IMPplj4TAuPApla6lFuYP5Jm8nROWn9fbm9eSere3rg94LCRAvm4rGcxlMCksLngwTxAgAyudeSUYEMMerxnQcACpqArpwcEAMw5vKxRPmQBPBjAAqYgPIEEUORGRFhvPmVPqJYPvZ0B58AgJsMvWb/kiyUAIW5GZJ0zmdesukfUFDuZF92aBOnE/quBlwTPE/vPHn4ivHNK/FT/bvMfBYuUpVyrBHEAAAAASUVORK5CYII=);
  background-size: contain;
 }

.app .options .brank li img { float: left; display: block; width: 1.375rem; height: 1.375rem; border-radius: 100%; }
.app .options .brank .text { padding-left: 1.75rem; color:#333; }
.app .options .brank .num { padding-right: 0.3125rem; }

.app .options .jian { width: 1.5625rem; height: 100%; display: box; display: -webkit-box; box-orient: horizontal; -webkit-box-orient: horizontal;
  box-align: center;  -webkit-box-align: center;  box-pack: end;  -webkit-box-pack: end; }
.app .options .jian i ,.brank-list ul li .jian i{  display: block; width: 0.375rem;  height: 0.625rem;   background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAAXNSR0IArs4c6QAAAMBJREFUKBWVk0EKwjAQRWfSpeDOQ6m3KO7ETUE8Q1G6EXfSW4ins6M/IaGJE5IOBNrkv9+fTMMiwtfhsaVfnbvjm5kFz7kyEH9kemH0w/0Jg5wY82a+KEJtCTIuBo0eLEH284jhnKn1IDONl+50SPcU8tZCAYBzDRQBNdAfUIQg0EqL17DZR33QwHROBTR3HLPtWeqQE/ueRJsuiWEegBpxAGrFFlgiBtCs1pvdJHLDCyr307nV5D6UxNYQkZZc0S/wgbqfxlfBrwAAAABJRU5ErkJggg==) no-repeat;
    background-size: 0.375rem; }

.app .explain { height: 1.125rem; line-height: 1.125rem; padding: 0.75rem; font-size: 0.75rem; }
.app .explain em {  color: #F24637; }

.app .submit {  padding: 1.5625rem 0.75rem;  text-align: center; }
.app .submit .btn { height: 2.8125rem; line-height: 2.8125rem; font-size: 1rem; border-radius: 0.25rem;  text-align: center; color: #fff;  background: #F24637; }
.app .submit .unbind { background: #DBDBDB; }
.app .submit .btn i { display: none; }
.app .submit .loading i { display: inline-block; width: 1.375rem;  height: 1.375rem;  margin-left: 0.3125rem;  background: url(images/loading.gif) no-repeat;
    background-size: 1.375rem; vertical-align: middle; }

.app .error { position: fixed; left: 50%; top: 50%; height: 1.75rem; line-height: 1.75rem; margin-left: -100px; margin-top: 1.75rem; padding: 0.6875rem 1.875rem;  border-radius: 0.25rem; background: rgba(0, 0, 0, 0.69); }

.brank-list{ position: fixed; z-index: 1; left: 0; bottom: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, .69); transition-duration: .3s; -webkit-transition-duration:.3s; opacity: 0;}
.brank-list .brank-content{ position: absolute; left: 0; bottom: 0; width: 100%; background: #fff; transition-duration: .3s; -webkit-transition-duration:.3s; transform:translateY(300px); -webkit-transform:translateY(300px); }
.brank-list.current{ opacity: 1; z-index: 998;}
.brank-list.current .brank-content{ transform:translateY(0px); -webkit-transform:translateY(0px); }
.brank-list .brank-content > h2{ height: 3.75rem; line-height: 3.75rem; text-align: center; font-size: 1.0625rem; }
.brank-list ul li{ width: 100%; padding: .625rem .9375rem; border-top: 1px solid #E2E2E2; display: box; background: #fff; display: -webkit-box; box-orient:horzontal; -webkit-box-orient: horzontal; box-align:center; -webkit-box-align:center; box-sizing: border-box; -webkit-box-sizing:border-box;}
.brank-list ul li:nth-child(odd){ background: #F8F8F8;}
.brank-list ul li .text{ padding-left: .625rem; box-flex: 1; -webkit-box-flex: 1; }
.brank-list .brank-content .img,.brank-list .brank-content .img img{ width: 1.375rem; height: 1.375rem; display: block; border-radius: 100%; }
.brank-list ul li h2{ height:1.4375rem; line-height: 1.4375rem;  font-size: 1rem; color: #333;}
.brank-list ul li .text p{ height: 1.0625rem; line-height: 1.0625rem; color: #878C92; }
.brank-list ul li .jian{ width: 1rem; padding:1rem .75rem;}

.error{  position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; display: box; display: -webkit-box; box-orient:horzontal; -webkit-box-orient: horzontal; box-align:center; -webkit-box-align:center; box-pack:center; -webkit-box-pack:center; }
.error.current{ z-index: 999;  }
.error .text{ transition-duration: .3s; -webkit-transition-duration:.3s; opacity: 0; height:1.75rem; line-height:1.75rem; padding: 0.6875rem 1.875rem; border-radius: 4px; background: rgba(0,0,0,.69);  color: #ddd; font-weight: normal; transform:translateY(100px); -webkit-transform:translateY(100px);}
.error.current .text{ transform:translateY(0px); -webkit-transform:translateY(0px); opacity: 1; }
    </style>
<body>


<article id="APP" class="container">
    <div class="app">
        <nav>
            <li class="current" id="bankToBroker" direct="1">银行转证券</li>
            <li id="brokerToBank" direct="2">证券转银行</li>
        </nav>
        <section class="options">
            <article class='tab1'>
                <ul class="brank" id="goToBankList">
                    <li class="label" >选择银行</li>
                    <li class="flex">
                        <img src='' id="bankLogo" style="display:none"/>
                        <div class="text">
                            <span class="num" id="bankAccount"></span>
                            <span id="bankName"></span>
                        </div>
                    </li>
                    <li class="jian"><i></i></li>
                </ul>
                <input type="hidden" id="currentBankNo"/>
                <ul>
                    <li class="label">转账金额</li>
                    <li class="flex"><input class="flex money" id="transAmount" placeholder="请输入转账金额" /></li>
                    <li class="close transAmount"  onclick="clearValue('transAmount')" style="display:none" ></li>
                </ul>
                <ul id="bankPwd" style="display:none">
                    <li class="label">银行密码</li>
                    <li class="flex"><input class="flex brankpwd" id="currentBankPwd" type="password"
                                            placeholder="请输入银行密码" onpaste="return false"   />
                    </li>
                    <li class="close currentBankPwd"  onclick="clearValue('currentBankPwd')" style="display:none" ></li>
                </ul>
                <ul id="fundPwd" style="display:none">
                    <li class="label">资金密码</li>
                    <li class="flex"><input class="flex mpwd" id="currentFundPwd" type="password"
                                            placeholder="请输入资金密码" onpaste="return false"   /></li>
                    <li class="close currentFundPwd"  onclick="clearValue('currentFundPwd')" style="display:none"></li>
                </ul>
            </article>
            <div class="explain" id="bankTip" style="display:none"></div>
            <div class="submit">
                <div class="btn unbind" id="submitBtn">提交<i></i></div>
            </div>
        </section>
    </div>
    <div class="brank-list" id="bank-list"> <!-- class='brank-list current' 时显示 选择银行 -->
        <div class="brank-content">
            <h2>选择银行</h2>
            <ul id="bank-account-list">
            </ul>
        </div>
    </div>
    <div class="error" id="alert-dialog"><!-- class='error current' 显示错误 -->
        <div class='text' id="alert-content">错误内容</div>
    </div>

    <input id="bankAccountDetail" type="hidden"/>

</article>

<script id="tmpl" type="text/template">
    <li class="bank-account-item" id="bank-item-{{bankNo}}" onclick="changeBank({{bankNo}})">
        <div class="img"><img src='{{bankLogo}}' /></div>
        <div class="text">
            <h2 class="bankName">{{bankName}}</h2>
            <p class="bankAccount">{{bankAccount}}</p>
            {{#bankPwdCfgList}}
            <input class="pwd-cfg-{{bizType}}-needFundPwd" value="{{needFundPwd}}" type="hidden"/>
            <input class="pwd-cfg-{{bizType}}-needBankPwd" value="{{needBankPwd}}" type="hidden"/>
            <input class="pwd-cfg-{{bizType}}-needTradePwd" value="{{needTradePwd}}" type="hidden"/>
            {{/bankPwdCfgList}}

        </div>
        <div class="jian" ><i></i></div>
    </li>
</script>
<script src="/html/js/mustache.min.js"></script>
<!--<script src='http://js.jrj.com.cn/common/foot/jrj_dcs_tag-min.js' type="text/javascript"></script>-->
<script>
        var bankTipArray =new Array();

        var bankTip = new Object();
        bankTip.code=5300;
        bankTip.msg="签约输入电话银行密码，而不是交易密码。如不确定，建议使用其他银行卡。";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=6000;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5600;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=7100;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=7300;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5700;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=7400;
        bankTip.msg="该行借记卡不支持绑定多家三方存管，如不确定，可使用其他银行卡。";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=6100;
        bankTip.msg="开户成功后，首笔银证转账需通过银行网银或电话银行转账激活三方存管。";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=6300;
        bankTip.msg="开户成功后，首笔银证转账需通过银行网银或电话银行转账激活三方存管。";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5500;
        bankTip.msg="开户成功后，首笔银证转账需通过银行网银或电话银行转账激活三方存管。该行借记卡不支持绑定多家三方存管，如不确定，可使用其他银行卡。";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5200;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=6200;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5900;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5800;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5100;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5000;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=5400;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=7600;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=7700;
        bankTip.msg="该行借记卡不支持绑定多家三方存管，如不确定，可使用其他银行卡。";
        bankTipArray.push(bankTip);

        bankTip = new Object();
        bankTip.code=7500;
        bankTip.msg="";
        bankTipArray.push(bankTip);

        var showBankTip = function(bankNo){
            var bankMsg=getBankMsg(bankNo);
            if(!isEmpty(bankMsg)){
                $("#bankTip").html("<em>＊</em>"+bankMsg);
                $("#bankTip").show();
            }else{
                $("#bankTip").html("");
            }
        }

        var getBankMsg = function(bankNo){
            for(var i=0;i<bankTipArray.length;i++){
                if(bankTipArray[i].code==bankNo){
                    return bankTipArray[i].msg;
                }
            }
            return "";
        }

        var domain=location.protocol+"//"+location.host;

        $('#currentBankPwd,#currentFundPwd,#transAmount').bind('input propertychange', function() {
            var inputVal=$(this).val();
            var bizId=$(this).attr("id");
            if(isEmpty(inputVal)){
                $("li."+bizId).hide();
            }else{
                $("li."+bizId).show();
            }

            toggleSubmitBtn();
        });


        // control submit btn gray or not
        var toggleSubmitBtn = function(){

            var bizType=$(".current").attr("direct");
            var currentBankNo=$("#currentBankNo").val();
            var needFundPwd=$("#bank-item-"+currentBankNo).find(".pwd-cfg-"+bizType+"-needFundPwd").val();
            var needBankPwd=$("#bank-item-"+currentBankNo).find(".pwd-cfg-"+bizType+"-needBankPwd").val();

            var transAmount=$("#transAmount").val();
            if(!isEmpty(transAmount)){
                $("#submitBtn").attr("class","btn");
                return ;
            }

            var btnClass=$("#submitBtn").attr("class");

            if(needFundPwd==1){
                if(!isEmpty($("#currentFundPwd").val())){
                   $("#submitBtn").attr("class","btn");
                }else{
                   if(btnClass=='btn'){
                        $("#submitBtn").attr("class","btn unbind");
                   }
                }
                return ;
            }
            if(needBankPwd==1){
                if(!isEmpty($("#currentBankPwd").val())){
                    $("#submitBtn").attr("class","btn");
                }else{
                    if(btnClass=='btn'){
                        $("#submitBtn").attr("class","btn unbind");
                    }
                }
                return ;
            }

        }


        $('#transAmount').bind('input propertychange', function() {
            var inputVal=$(this).val();
            var bizId=$(this).attr("id");
            if(isEmpty(inputVal)){
                $("li."+bizId).hide();
            }else{
                $("li."+bizId).show();
            }
        });


        var showAlertDialog = function(str){
            //alert-content

            $("#alert-content").text(str);
            $("#alert-dialog").attr("class","error current");
            $("#alert-dialog").fadeIn(2000);
            $("#alert-dialog").fadeOut(2000);
            //$("#alert-dialog").attr("class","error");
        }

        var closeAlertDialog = function(){
            $("#alert-dialog").attr("class","error");
        }

        $("#alert-dialog").click(function(){
            closeAlertDialog();
        })

        var clearValue = function(id){
            $("#"+id).val("");
            $("li."+id).hide();
            toggleSubmitBtn();
        }

        var changeBank=function(bankNo){
            var bizType=$(".current").attr("direct");
            var needFundPwd=$("#bank-item-"+bankNo).find(".pwd-cfg-"+bizType+"-needFundPwd").val();
            var needBankPwd=$("#bank-item-"+bankNo).find(".pwd-cfg-"+bizType+"-needBankPwd").val();
            var bankLogo=$("#bank-item-"+bankNo).find("img").attr("src");
            var bankName=$("#bank-item-"+bankNo).find(".bankName").text();
            var bankAccount=$("#bank-item-"+bankNo).find(".bankAccount").text();
            //alert(needFundPwd +"----" +needBankPwd +"-----"+bankLogo+"-----"+bankName+"-----"+bankAccount);

            $("img#bankLogo").attr("src",bankLogo);
            $("span#bankAccount").text(bankAccount);
            $("span#bankName").text(bankName);
            $("input#currentBankNo").val(bankNo);
            showBankTip(bankNo);
            if(needBankPwd == 1){
                    $("ul#bankPwd").show();
            }else{
                    $("ul#bankPwd").hide();
            }

            if(needFundPwd == 1){
                    $("ul#fundPwd").show();
            }else{
                 $("ul#fundPwd").hide();
            }

            $("div#bank-list").attr("class","brank-list");

        }


        var fomatBankAccount = function(str){
                return str.substring(0,4)+"****"+str.substring(str.length-4,str.length)
            };

        var convertToJsonObject = function(str){
            if(typeof str != 'object'){
              return JSON.parse(str);
            }else{
              return str;
            }
        }

        // reset current panel
        var resetPanel = function(){
              clearValue('transAmount');
              clearValue('currentBankPwd');
              clearValue('currentFundPwd');
           // $("#transAmount").val("");
           // $("#currentBankPwd").val("");
           // $("#currentFundPwd").val("");
        }

        // switch To Tab
        var switchTab = function(tabId){
            $("#bankToBroker").removeClass("current");
            $("#brokerToBank").removeClass("current");
            $("#"+tabId).addClass("current");
            $("#submitBtn").attr("class","btn unbind");
        }

        $("#goToBankList").click(function(){
            //dcsMultiTrack('DCS.dcsuri','click_yzzz_xzyh','WT.ti','click_yzzz_xzyh');
            $("div#bank-list").attr("class","brank-list current");

        })

        $('#bank-list').click(function(){
            $("div#bank-list").attr("class","brank-list");
        });

        $('#bank-list > .brank-content').click(function(e){
            e.stopPropagation();
        });

        var fillBankAccountList = function(bankAccountInfo){
            var items=bankAccountInfo.data.items;
            if(items.length<=0){
              return;
            }
            $("#bank-account-list").empty();
            for(var i=0;i<items.length;i++){
                var _html = $('#tmpl').html()
                items[i].bankAccount=fomatBankAccount(items[i].bankAccount);
                var tmpItem=Mustache.render(_html, items[i]);
                $("#bank-account-list").append(tmpItem);
            }
        }
        //获取当前密码配置
        var getCurrentPwdCfg = function(item){
            // 当前业务号
            var bizType=$(".current").attr("direct");
            var bankPwd=item.bankPwdCfgList;
            for(var idx=0;idx<bankPwd.length;idx++){
                if(bankPwd[idx].bizType==bizType){
                    return bankPwd[idx];
                }
            }
        }

        var initPage=function(bankAccountInfo){
                var item = bankAccountInfo.data.items[0];
                var pwdCfg=getCurrentPwdCfg(item);
                var bankAccount = item.bankAccount;
                var bankName = item.bankName;
                var needBankPwd = pwdCfg.needBankPwd;
                var needFundPwd = pwdCfg.needFundPwd;

                $("img#bankLogo").attr("src",item.bankLogo);
                $("span#bankAccount").text(fomatBankAccount(bankAccount));
                $("span#bankName").text(bankName);
                $("input#currentBankNo").val(item.bankNo);

                $("img#bankLogo").show();
                showBankTip(item.bankNo);

                if(needBankPwd == 1){
                    $("ul#bankPwd").show();
                }else{
                    $("ul#bankPwd").hide();
                }

                if(needFundPwd == 1){
                    $("ul#fundPwd").show();
                }else{
                    $("ul#fundPwd").hide();
                }

        }
        //回调
        window.callbackFunc =function(bankAccountInfo){
             setTimeout(function(){
                 bankAccountInfo = convertToJsonObject(bankAccountInfo);
                 initPage(bankAccountInfo);
                 fillBankAccountList(bankAccountInfo);
                 $("#bankAccountDetail").val(JSON.stringify(bankAccountInfo));
             },0);
               // console.log(JSON.stringify(bankAccountInfo));
                //alert(JSON.stringify(bankAccountInfo));


            }

       var queryBankAccountDetail = function(){

            setTimeout(function(){
              jrj.jsCallNative('130', JSON.stringify({
                                method: 'get',
                                url: domain+'/sapi/v2/banktrans/getBankAccountDetail',
                                params: {
                                },
                                callback: 'callbackFunc',
                                version:'3.10.0'
             }));

             },200);
       }

       window.onload=function(){
        queryBankAccountDetail();
       }


      var isEmpty=function(str){
         return str == '' || str== null ||str=="";
      }


      $("#submitBtn").click(function(e){
        //dadian
        //dcsMultiTrack('DCS.dcsuri','click_yzzz_tj','WT.ti','click_yzzz_tj');

        //gray submit btn not click
        var btnClass=$("#submitBtn").attr("class");
        if(btnClass=='btn unbind'){
            return ;
        }
        //go....
        var bizType=$(".current").attr("direct");

        var dto=new Object();
        dto.occurBalance=$("#transAmount").val();
        dto.bankNo=$("#currentBankNo").val();
        dto.fundPassword=$("#currentFundPwd").val();
        dto.bankPassword=$("#currentBankPwd").val();
        dto.direct=bizType;
        dto.moneyType="CNY";

        if(isEmpty(dto.occurBalance)||dto.occurBalance==0|| isNaN(dto.occurBalance)){
            showAlertDialog("请输入合理的转账金额");
            return;
        }

        var bizType=$(".current").attr("direct");
        var needFundPwd=$("#bank-item-"+dto.bankNo).find(".pwd-cfg-"+bizType+"-needFundPwd").val();
        var needBankPwd=$("#bank-item-"+dto.bankNo).find(".pwd-cfg-"+bizType+"-needBankPwd").val();

        if(needBankPwd==1&&isEmpty(dto.bankPassword)){
            showAlertDialog("输入银行密码有误!")
            return;
        }

        if(needFundPwd==1&&isEmpty(dto.fundPassword)){
            showAlertDialog("输入资金密码有误!")
            return;
        }

        $("#submitBtn").attr("class","btn unbind");
        jrj.jsCallNative('130', JSON.stringify({
                            method: 'post',
                            url: domain+'/sapi/v2/banktrans/doTrans',
                            params: dto,
                            header:{
                               'Content-Type':'application/json'
                            },
                            callback: 'callbackTransFunc',
                            version:'3.11.0',
                            encrypt:'1'
         }));

      })

    var callbackTransFunc=function(transResp){
         setTimeout(function(){
            transResp=convertToJsonObject(transResp);
            //active submitBtn
            $("#submitBtn").attr("class","btn");
            if(transResp.retcode==0){
                resetPanel();
                showAlertDialog("请求已经发送到银行请稍后查询结果");
            }else{
                showAlertDialog(transResp.msg);
            }
         },0);
       }

    $("#bankToBroker,#brokerToBank").click(function(){
        var tabId=$(this).attr("id");
        switchTab(tabId);
        resetPanel();
        var bankAccountDetail=jQuery.parseJSON($("#bankAccountDetail").val());
        initPage(bankAccountDetail);
    })

</script>

</body>
</html>